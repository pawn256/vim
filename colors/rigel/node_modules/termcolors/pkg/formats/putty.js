'use strict';

var _ = require('lodash');

var createExporter = require('../exporter');

var template = "Windows Registry Editor Version 5.00 \n\n[HKEY_CURRENT_USER\\Software\\SimonTatham\\PuTTY\\Sessions\\Default%20Settings]\n\"Colour0\"=\"{{=c.foreground}}\"\n\"Colour1\"=\"{{=c.foreground}}\"\n\"Colour2\"=\"{{=c.background}}\"\n\"Colour3\"=\"{{=c.background}}\"\n\"Colour4\"=\"{{=c.background}}\"\n\"Colour5\"=\"{{=c.foreground}}\"\n\"Colour6\"=\"{{=c[0]}}\"\n\"Colour7\"=\"{{=c[8]}}\"\n\"Colour8\"=\"{{=c[1]}}\"\n\"Colour9\"=\"{{=c[9]}}\"\n\"Colour10\"=\"{{=c[2]}}\"\n\"Colour11\"=\"{{=c[10]}}\"\n\"Colour12\"=\"{{=c[3]}}\"\n\"Colour13\"=\"{{=c[11]}}\"\n\"Colour14\"=\"{{=c[4]}}\"\n\"Colour15\"=\"{{=c[12]}}\"\n\"Colour16\"=\"{{=c[5]}}\"\n\"Colour17\"=\"{{=c[13]}}\"\n\"Colour18\"=\"{{=c[6]}}\"\n\"Colour19\"=\"{{=c[14]}}\"\n\"Colour20\"=\"{{=c[7]}}\"\n\"Colour21\"=\"{{=c[15]}}\"\n";

module.exports = {
  export: createExporter(template, _.partialRight(_.mapValues, function (color) {
    return color.toRgbArray().join();
  }))
};
